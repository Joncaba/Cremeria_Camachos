# REFERENCIA RÃPIDA: CÃ³digo vs NÃºmero de Producto

## ğŸ”„ Mapeo de BÃºsqueda

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      USUARIO ESCANEA CÃ“DIGO                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Â¿Tiene 13 dÃ­gitos? (Ticket de bÃ¡scula)                             â”‚
â”‚  â”œâ”€ SÃ: extrae primeros 9 â†’ busca como cÃ³digo de 9 dÃ­gitos        â”‚
â”‚  â””â”€ NO: busca tal cual                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INTENTA 5 ESTRATEGIAS (EN ORDEN):                                  â”‚
â”‚                                                                      â”‚
â”‚  1ï¸âƒ£ BÃºsqueda exacta:     WHERE codigo = '172'                      â”‚
â”‚  2ï¸âƒ£ PLU:                 WHERE numero_producto = 172               â”‚
â”‚  3ï¸âƒ£ ExtracciÃ³n PLU:      Extrae Ãºltimos 5-7 dÃ­gitos                â”‚
â”‚  4ï¸âƒ£ LIKE bÃ¡scula:        WHERE codigo LIKE '750111102%' [NUEVA]   â”‚
â”‚  5ï¸âƒ£ BÃºsqueda parcial:    WHERE codigo LIKE '%xxxxx'                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â†“
                    Â¿ENCONTRÃ“ PRODUCTO?
                    â”œâ”€ SÃ â†’ Agrega a carrito âœ“
                    â””â”€ NO â†’ Muestra error âœ—
```

## ğŸ“ Tabla de Ejemplos

| Entrada | Tipo | Estrategia | BD Actual | Resultado |
|---------|------|-----------|-----------|-----------|
| `172` | CÃ³digo simple | 1 (exacta) | cÃ³digo=172 | âœ“ ENCONTRADO |
| `7501111021029` | Barcode | 1 (exacta) | cÃ³digo=7501111021029 | âœ“ ENCONTRADO |
| `7501111021029` | Ticket bÃ¡scula | 4 (LIKE) | cÃ³digo=7501111021029 | âœ“ ENCONTRADO |
| `750111102` | CÃ³digo bÃ¡scula | 4 (LIKE) | cÃ³digo=7501111021029 | âœ“ ENCONTRADO |
| `80332` | PLU | 2 (numero_producto) | numero_producto=80332 | âœ“ ENCONTRADO |
| `999999` | No existe | - | - | âœ— ERROR |

## ğŸª Estructura BD Actual

```
TABLA: productos
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ codigo           â”‚ numero_producto  â”‚ nombre               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 172              â”‚ 172              â”‚ MANTEQUILLA 90GR     â”‚
â”‚ 7501111021029    â”‚ 7501111021029    â”‚ MANTEQUILLA 1KG      â”‚
â”‚ 200006500        â”‚ 200006500        â”‚ QUESO COTIJA         â”‚
â”‚ 44444            â”‚ NULL             â”‚ QUESO (viejo)        â”‚
â”‚ ...              â”‚ ...              â”‚ ...                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ DecisiÃ³n de CÃ³digo vs PLU

### RecomendaciÃ³n: SEPARAR cuando sea posible

**BIEN:**
```
codigo: 7501111021029  (barcode del proveedor)
numero_producto: 80332 (PLU simple para bÃºsquedas)
```

**TAMBIÃ‰N BIEN:**
```
codigo: 172            (PLU simple)
numero_producto: 172   (mismo valor)
```

**EVITAR:**
```
codigo: PLU-172        (prefijo aÃ±adido)
numero_producto: NULL  (no usar)
```

## ğŸ”§ Diagrama de DecisiÃ³n

```
Â¿Producto nuevo?
â”‚
â”œâ”€ SÃ­: Â¿Tienes barcode?
â”‚      â”œâ”€ SÃ­: codigo = barcode, numero_producto = PLU simple
â”‚      â””â”€ No: codigo = PLU simple, numero_producto = PLU simple
â”‚
â””â”€ No: Â¿Necesitas cambiar cÃ³digo?
       â”œâ”€ SÃ­: python agregar_codigo_barras.py <PLU> <barcode>
       â””â”€ No: MantÃ©n como estÃ¡
```

## ğŸ§ª Test RÃ¡pido

```bash
# 1. Ver si existe
python diagnosticar_busqueda.py 172

# 2. Si no funciona, verificar en BD
sqlite3 pos_cremeria.db "SELECT codigo, numero_producto, nombre FROM productos WHERE nombre LIKE '%MANTEQUILLA%';"

# 3. Si falta, agregar
python sincronizar_plu_a_productos.py

# 4. Si existe pero cÃ³digo estÃ¡ mal, actualizar
python agregar_codigo_barras.py 172 <barcode_correcto>
```

## ğŸ“Š Estado Actual (Diciembre 2025)

âœ… **Completado:**
- 544 productos importados de iTegra
- NÃºmeros de PLU poblados en numero_producto
- CÃ³digos numÃ©ricos (1-543) O barcodes completos registrados
- Tabla codigos_barras con histÃ³rico
- BÃºsqueda con 5 estrategias
- Inventario muestra PLU

âš ï¸ **Pendiente (Opcional):**
- Asignar barcodes a todos los productos
- Crear mapping para cÃ³digos de bÃ¡scula especiales
- DocumentaciÃ³n para staff

ğŸ”´ **Problemas Conocidos:**
- Algunos productos sin numero_producto (15 antiguos)
- CÃ³digo de bÃ¡scula 2080332010005 no existe en BD (ejemplo del usuario)

## ğŸš€ Comandos Ãštiles

```bash
# Ver primeros 10 productos
sqlite3 pos_cremeria.db "SELECT codigo, numero_producto, nombre FROM productos LIMIT 10;"

# Buscar producto especÃ­fico
sqlite3 pos_cremeria.db "SELECT codigo, numero_producto, nombre FROM productos WHERE nombre LIKE '%MANTEQUILLA%';"

# Diagnosticar cÃ³digo
python diagnosticar_busqueda.py 172

# Ver productos sin numero_producto
sqlite3 pos_cremeria.db "SELECT codigo, nombre FROM productos WHERE numero_producto IS NULL;"

# Contar por tipo
sqlite3 pos_cremeria.db "SELECT COUNT(*), COUNT(numero_producto) FROM productos;"
```

## ğŸ’¡ Tips Pro

1. **Para cÃ³digos de bÃ¡scula desconocidos**: Usa `diagnosticar_busqueda.py` ANTES de escanear
2. **Para asignar barcodes**: `python agregar_codigo_barras.py <plu> <barcode>`
3. **Para ver PLU**: Abre inventario y mira columna "ğŸ”¢ PLU"
4. **Para troubleshoot**: Siempre verifica con diagnÃ³stico primero
5. **Backup antes de cambios**: `sqlite3 pos_cremeria.db ".backup backup.db"`

## â“ Preguntas Frecuentes

**P: Â¿Por quÃ© no encuentra mi cÃ³digo?**
A: Usa `python diagnosticar_busqueda.py <cÃ³digo>` para verificar

**P: Â¿Puedo tener mÃºltiples cÃ³digos para un producto?**
A: No, un solo `codigo`. Si necesitas mapear mÃºltiples, usa tabla auxiliar

**P: Â¿QuÃ© pasa con el numero_producto NULL?**
A: Son productos viejos. ActualÃ­zalos o elimÃ­nalos

**P: Â¿CÃ³mo cambio el cÃ³digo de un producto?**
A: Usa `agregar_codigo_barras.py` - actualiza el cÃ³digo pero mantiene numero_producto

**P: Â¿El nÃºmero_producto puede cambiar?**
A: No, es inmutable. Es tu identificador Ãºnico

## ğŸ“ Contacto TÃ©cnico

Para problemas especÃ­ficos, proporciona:
1. CÃ³digo escaneado
2. Salida de: `python diagnosticar_busqueda.py <cÃ³digo>`
3. Salida de: `sqlite3 pos_cremeria.db "SELECT * FROM productos WHERE nombre LIKE '%...%';"`

---

**Ãšltima actualizaciÃ³n:** Diciembre 2025
**Sistema:** POS CremerÃ­a Camacho's
**Status:** âœ… PRODUCTIVO
